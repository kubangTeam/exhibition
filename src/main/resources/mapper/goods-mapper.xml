<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Config 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.hqu.cst.kubang.exhibition.dao.GoodsDao">

    <sql id="selectFields">
        goodsintroduce.goodsId,goodsName,categoryId,goodsAreaNumber,companyId,website,originPlace,originalPrice,currentPrice,goodsIntroduce,startTime,endTime,goodsStatus,priority,pic,picId
    </sql>
    <select id="selectGoodsById" resultType="Goods">
           select <include refid="selectFields"></include>
           from goodsintroduce left join goodspicture on(goodsintroduce.goodsId=goodspicture.goodsId)
           where goodsintroduce.goodsId = #{goodsId}
    </select>
    <select id="selectGoodsByName" resultType="Goods">
        select <include refid="selectFields"></include>
        from goodsintroduce left join goodspicture on(goodsintroduce.goodsId=goodspicture.goodsId)
        where goodsStatus = #{goodsStatus} and goodsName = #{goodsName}
    </select>
    <select id="selectGoodsByCompanyId" resultType="Goods">
        select <include refid="selectFields"></include>
        from goodsintroduce left join goodspicture on(goodsintroduce.goodsId=goodspicture.goodsId)
        where goodsStatus = #{goodsStatus} and companyId = #{companyId}
    </select>
    <select id="selectGoodsByCategoryId" resultType="Goods">
        select <include refid="selectFields"></include>
        from goodsintroduce left join goodspicture on(goodsintroduce.goodsId=goodspicture.goodsId)
        where goodsStatus = #{goodsStatus} and categoryId = #{categoryId}
        order by priority
    </select>
    <select id="selectGoodsCount" resultType="int">
        select count(*)
        from goodsintroduce
    </select>
   <!-- <select id="selectGoodsByKeyword" resultType="Goods">
    select <include refid="selectFields"></include>
    from goodsintroduce join goodskeywords
    on goosintroduce.goodsId = goodskeywords.goodsId
    where goodsStatus = #{goodsStatus} and keyword = #{keyword}
    </select>-->
    <select id="selectStatusById" resultType="int">
        select goodsStatus
        from goodsintroduce
        where goodsId = #{goodId}
    </select>
    <insert id="insertGoods" parameterType="Goods" useGeneratedKeys="true" keyProperty="goodsId">
        insert into goodsintroduce
        (goodsName,categoryId,goodsAreaNumber,companyId,website,originPlace,originalPrice,currentPrice,goodIntroduce,
        startName,endTime,goodStatus,priority)
        values
        (#{goodsName},#{categoryId},#{goodsAreaNumber},#{companyId},#{website},#{originPlace},#{orginalPrice},
        #{currentPrice},#{goodsIntroduce},#{startTime},#{endTime},#{goodStatus},#{priority})
    </insert>
    <insert id="insertGoodsPic">
        insert into goodspicture
        (goodsId,pic)
        value
        (#{goodsId},#{pic})
    </insert>
    <update id="updatePriority">
        update goodsintroduce set priority = #{priority} where goodsId = #{goodsId}
    </update>
    <update id="updateStatus">
        update goodsintroduce set goodsStatus = #{goodsStatus} where goodsId = #{goodsId}
    </update>
    <delete id="deleteGoods">
        delete from goodsintroduce left join goodspicture on(goodsintroduce.goodsId=goodspicture.goodsId)
        where goodsId = #{goodsId}
    </delete>

</mapper>