<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.edu.hqu.cst.kubang.exhibition.dao.UserInformationDao">

    <sql id="selectFields">
        userId,userAccount,userCompanyId,userName,userPassword,userSex,userPermission,userIntegral,userReccode,
        userPicture,userChooseCity,userEmail,userOrganizerId
    </sql>

    <sql id="insertFields">
        userAccount,userCompanyId,userName,userPassword,userSex,userPermission,userIntegral,userReccode,
        userPicture,userChooseCity,userEmail,userOrganizerId
    </sql>

    <select id="selectById" resultType="UserInformation">
        select * from userinformation where userId = #{id}
    </select>
    <insert id="UserRegisterFromPhoneNumber" parameterType="String">
        INSERT INTO `kubang`.`userinformation` (`userAccount`, `userName`, `userPassword`, `userSex`, `userIntegral`, `userReccode`)
        VALUES (#{phoneNumber}, #{newUserName}, #{password}, 'male', '0', #{newRecCode})
    </insert>
    <insert id="UserRegisterFromEmail" parameterType="String">
        INSERT INTO `kubang`.`userinformation` (`userId`, `userAccount`, `userName`, `userPassword`, `userSex`, `userIntegral`, `userReccode`)
        VALUES (#{UserID}, #{email}, #{newUserName}, #{password}, 'male', '0', #{newRecCode})
    </insert>
    <select id="GetUseInfoFromAccount" parameterType="String" resultType="UserInformation">
        SELECT * from `kubang`.`userinformation` where userAccount=#{account}
    </select>
    <select id="GetUserInfoFromId" parameterType="int" resultType="UserInformation">
        SELECT * from `kubang`.`userinformation` where userId=#{userId}
    </select>
    <update id="AddUserPoint" parameterType="String">
        UPDATE `kubang`.`userinformation` SET `userIntegral`='userIntegral'+10 WHERE `userRecCode`=#{recCode};
    </update>
    <update id="UpdatePassword" parameterType="String">
        UPDATE `kubang`.`userinformation` SET `userPassword`=#{newPassword} WHERE  `userAccount`=#{account}
    </update>
    <update id="UpdateUserInfo_Name" parameterType="String">
        UPDATE `kubang`.`userinformation` SET `userName`=#{userName}WHERE userAccount=#{account}
    </update>
    <update id="UpdateUserInfo_UserSex" parameterType="String">
        UPDATE `kubang`.`userinformation` SET `userSex`=#{userSex} WHERE userAccount=#{account}
    </update>
    <update id="UpdateUserInfo_UserPicture" parameterType="String">
        UPDATE `kubang`.`userinformation` SET `userPicture`=#{picture} WHERE userAccount=#{account}
    </update>
    <update id="saveUserEmail" parameterType="map">
        update userinformation set userEmail = #{userEmail} where userId = #{userId};
    </update>
    <select id="IsUserEmailBind" parameterType="String" resultType="int">
        select count(userId) from userinformation where userEmail = #{email};
    </select>



    <select id="GetUserInfoFromOrganizerId" parameterType="int" resultType="UserInformation">
        select <include refid="selectFields"></include>
        from userinformation
        where userOrganizerId = #{userOrganizerId}
    </select>
</mapper>